/*! For license information please see Multinomial.js.LICENSE.txt */
import{Multinomial}from"@tensorflow/tfjs-core";import{softmax}from"./Softmax";let wasmMultinomial;function setup(t){wasmMultinomial=t.wasm.cwrap(Multinomial,null,["number","number","number","number","number","number"])}export function multinomial(t){const{inputs:a,backend:e,attrs:n}=t,{logits:m}=a,{numSamples:o,seed:i,normalized:l}=n;if("float32"!==m.dtype)throw new Error(`Tensor logits must have dtype float32, got ${m.dtype}`);const s=l?m:softmax({inputs:{logits:m},backend:e,attrs:{dim:m.shape.length-1}}),[u,r]=s.shape,d=e.makeOutput([u,o],"int32");return wasmMultinomial(e.dataIdMap.get(s.dataId).id,u,r,o,i,e.dataIdMap.get(d.dataId).id),l||e.disposeData(s.dataId),d}export const multinomialConfig={kernelName:Multinomial,backendName:"wasm",setupFunc:setup,kernelFunc:multinomial};