/*! For license information please see SpaceToBatchND.js.LICENSE.txt */
import{backend_util,SpaceToBatchND,util}from"@tensorflow/tfjs-core";import{padV2Config}from"./PadV2";import{reshape}from"./Reshape";import{transpose}from"./Transpose";function spaceToBatchND(e){const{inputs:a,backend:t,attrs:s}=e,{x:n}=a,{blockShape:p,paddings:o}=s,r=util.sizeFromShape(p),d=[[0,0]];d.push(...o);for(let e=1+p.length;e<n.shape.length;++e)d.push([0,0]);const c=padV2Config.kernelFunc({inputs:{x:n},backend:t,attrs:{paddings:d,constantValue:0}}),i=backend_util.getReshaped(c.shape,p,r,!1),h=backend_util.getPermuted(i.length,p.length,!1),u=backend_util.getReshapedPermuted(c.shape,p,r,!1),l=reshape({inputs:{x:c},backend:t,attrs:{shape:i}}),m=transpose({inputs:{x:l},backend:t,attrs:{perm:h}}),k=reshape({inputs:{x:m},backend:t,attrs:{shape:u}});return t.disposeData(c.dataId),t.disposeData(l.dataId),t.disposeData(m.dataId),k}export const spaceToBatchNDConfig={kernelName:SpaceToBatchND,backendName:"wasm",kernelFunc:spaceToBatchND};